(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[88],{4306:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var a=t(7876),n=t(4232),s=t(7125),c=t.n(s);function l(){let[e,r]=(0,n.useState)(()=>Array.from({length:24},()=>Array(24).fill(0))),[t,s]=(0,n.useState)(!1),[l,u]=(0,n.useState)([-1,-1]),o=(0,n.useRef)([-1,0]),i=(0,n.useRef)([-1,0]),[m,f]=(0,n.useState)([2,!1]),[_,d]=(0,n.useState)([[-1,-1]]),[h,g]=(0,n.useState)([-1,-1]),[k,v]=(0,n.useState)([-1,-1]),p=(0,n.useRef)([[0,0]]),[w,S]=(0,n.useState)([!1,0]);(0,n.useEffect)(()=>{j()},[e]),(0,n.useEffect)(()=>{r(e=>{if(null===l)return e;let r=e.map(e=>[...e]),[t,a]=l,[n,s]=k,c=_.map(e=>[...e]),[u,o]=h;return -1!==u&&(r[u][o]=0),-1!==t&&(r[t][a]=2,r[n][s]=3,c.forEach((e,t)=>{let[a,n]=e;r[a][n]=1})),r})},[l]),(0,n.useEffect)(()=>{if(!0===t){r(()=>Array.from({length:24},()=>Array(24).fill(0))),u([12,12]),d([[13,12]]),g([-1,-1]),o.current=[-1,0];let e=[];for(let r=0;r<24;r++)for(let t=0;t<24;t++)(12!==r||12!==t)&&(13!==r||12!==t)&&e.push([r,t]);p.current=e,x(),f([2,!0]),window.addEventListener("keydown",G)}return()=>{window.removeEventListener("keydown",G)}},[t]);let G=e=>{e.preventDefault();let r=e.key.toLowerCase(),t="";if("arrowup"===r||"w"===r)t="ArrowUp";else if("arrowdown"===r||"s"===r)t="ArrowDown";else if("arrowleft"===r||"a"===r)t="ArrowLeft";else{if("arrowright"!==r&&"d"!==r)return;t="ArrowRight"}switch(t){case"ArrowUp":if(1===i.current[0]&&0===i.current[1])return;o.current=[-1,0];break;case"ArrowDown":if(-1===i.current[0]&&0===i.current[1])return;o.current=[1,0];break;case"ArrowLeft":if(0===i.current[0]&&1===i.current[1])return;o.current=[0,-1];break;case"ArrowRight":if(0===i.current[0]&&-1===i.current[1])return;o.current=[0,1]}};(0,n.useEffect)(()=>{let e;return!0===m[1]&&(e=setTimeout(()=>{let[r,t]=l,[a,n]=[r+o.current[0],t+o.current[1]],c=0;if((a<0||a>=24||n<0||n>=24)&&(c=1),_.forEach((e,r)=>{let[t,s]=e;if(a===t&&n===s){if(r===_.length-1)return;c=2}}),0!==c){f([.5,!1]),s(!1),S([!0,c]),clearInterval(e);return}if(u([a,n]),i.current=[o.current[0],o.current[1]],a===k[0]&&n===k[1])d(e=>{let a=e.map(e=>[...e]);return a.unshift([r,t]),a}),x(),2==_.length?f([3,!0]):5===_.length?f([4,!0]):7===_.length?f([5,!0]):9===_.length&&f([6,!0]);else{let[e,s]=_[_.length-1];g([e,s]),d(e=>{let a=e.map(e=>[...e]);return a.unshift([r,t]),a.pop(),a});let c=p.current.findIndex(e=>{let[r,t]=e;return r===a&&t===n});p.current.splice(c,1),p.current.push([e,s])}},1e3/m[0])),()=>clearTimeout(e)},[m,l]);let x=()=>{let e=Math.floor(Math.random()*p.current.length),[r,t]=p.current[e];v([r,t]),p.current.splice(e,1)},j=()=>{let r=[],t=0,n={0:"",1:c().snakeBody,2:c().snakeHeader,3:c().food};for(let s=0;s<e.length;s++){let l=[];for(let r=0;r<e[s].length;r++)l.push((0,a.jsx)("div",{"data-x":s,"data-y":r,className:"".concat(c().GameMapCell," ").concat(n[e[s][r]])},t)),t++;r.push((0,a.jsx)("div",{className:c().GameMapCol,children:l},t)),t++}return(0,a.jsx)("div",{className:c().GameMap,children:r})};return(0,a.jsxs)("div",{className:c().game,children:[(0,a.jsxs)("div",{className:c().gameMenu,children:[(0,a.jsxs)("div",{children:["當前速度:","".concat(m[0]),"/s"]}),(0,a.jsxs)("div",{children:["得分:","".concat(_.length-1)]})]}),(0,a.jsxs)("div",{className:c().GameMapDiv,children:[(0,a.jsx)(j,{}),(0,a.jsx)("button",{className:"".concat(c().gameStartButton," bg-sky-300 hover:bg-sky-500 hover:not-focus:bg-sky-400 ").concat(!0===t||!0===w[0]?c().gameActive:""),onClick:()=>{s(!0)},children:"遊戲開始"}),(0,a.jsxs)("div",{className:"".concat(c().gameOverDiv," ").concat(!1===w[0]?c().gameOverClose:""," "),children:[(0,a.jsx)("h2",{children:"遊戲結束"}),(0,a.jsxs)("p",{children:["死因:","".concat(1===w[1]?"撞到牆":"咬到自己")]}),(0,a.jsxs)("p",{children:["最終得分:","".concat(_.length-1)]}),(0,a.jsx)("button",{className:" bg-sky-300 hover:bg-sky-500 hover:not-focus:bg-sky-400",onClick:()=>{S([!1,0])},children:"確認"})]})]})]})}function u(){return(0,a.jsx)("main",{children:(0,a.jsx)(l,{})})}},7125:e=>{e.exports={game:"SnakeGame_game__Ge3d_",gameMenu:"SnakeGame_gameMenu__XmU9d",GameMapDiv:"SnakeGame_GameMapDiv___vI4v",GameMap:"SnakeGame_GameMap__6gzDh",GameMapCol:"SnakeGame_GameMapCol__I26tT",GameMapCell:"SnakeGame_GameMapCell__uFIN8",snakeHeader:"SnakeGame_snakeHeader__NOzPv",snakeBody:"SnakeGame_snakeBody__gVsXl",food:"SnakeGame_food__nbdvq",gameStartButton:"SnakeGame_gameStartButton__6SmIz",gameActive:"SnakeGame_gameActive__Sja_h",gameOverDiv:"SnakeGame_gameOverDiv__kERmz",gameOverClose:"SnakeGame_gameOverClose__nXzmg"}},8276:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/Snake",function(){return t(4306)}])}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(8276)),_N_E=e.O()}]);